<!DOCTYPE html>
<html>
<head>
    <title>BHV Vault</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/water.css@2/out/water.css">
</head>
<body>
  
    <h1>Behavioral Health Vault</h1>
    <p>Digitizing recovery through images and textual narratives.</p>
    
    <form action="/upload" method="post" enctype="multipart/form-data">
        <label>Patient ID / Name:</label>
        <input type="text" name="patient_name" required>
        
        <label>Narrative (Story/Context):</label>
        <textarea name="narrative" rows="4" required></textarea>
        
        <label>Upload Image (Sketch or Photo):</label>
        <input type="file" name="file" accept="image/*" required>
        
        <button type="submit">Securely Save to Vault</button>
    </form>
    <hr>
    <h2>Recovery Gallery</h2>
    <div style="display: flex; flex-wrap: wrap; gap: 20px; margin-top: 20px;">
    {% for record in records %}
    <div style="border: 1px solid #444; padding: 15px; border-radius: 8px; width: 300px; background: #1e1e1e;">
        <img src="/{{ record.image_path }}" alt="Recovery Image" style="width: 100%; border-radius: 4px; margin-bottom: 10px;">
        
        <h4 style="margin: 0;">{{ record.patient_name }}</h4>
        <p style="font-size: 0.8em; color: #888;">{{ record.created_at.strftime('%Y-%m-%d') }}</p>
        <p>{{ record.narrative }}</p>
        
        <span style="background: #004d40; color: #e0f2f1; padding: 4px 8px; border-radius: 4px; font-size: 0.75em;">
            Emotion: {{ record.emotion_label }}
        </span>
    </div>
    {% endfor %}
</div>
    <div style="display: flex; flex-wrap: wrap; gap: 20px;">
        {% for record in records %}
        <div style="border: 1px solid #ccc; padding: 15px; border-radius: 8px; width: 300px;">
            <img src="{{ record.image_path }}" alt="Recovery Image" style="width: 100%; border-radius: 4px;">
            
            <h4>{{ record.patient_name }}</h4>
            <p><i>Uploaded on: {{ record.created_at.strftime('%Y-%m-%d') }}</i></p>
            <p>{{ record.narrative }}</p>
            
            <span style="background: #e0f7fa; padding: 5px; border-radius: 4px; font-size: 0.8em;">
                Emotion: {{ record.emotion_label }}
            </span>
        </div>
        {% endfor %}
    </div>
</body>
</html>